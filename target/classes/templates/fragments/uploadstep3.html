
<html  xmlns:th="http://www.thymeleaf.org">
  <head>

    <title>UI Page 3 - Upload Docs</title>
   
    <script>


		var stepper1 = null;
	
		var catalogObjectList;
		
    	$(document).ready(function() {	
     		hideSpinner();	
     		
     		if( $('#materialDataTable').length){
     			
     			var table = $('#materialDataTable').DataTable( {
            	retrieve: true,
     	 		searchHighlight: true,
             	responsive: true,		        
             	"paging":   true,	
             	scrollCollapse: true,
             	scrollY: 'calc(100vh - 35rem)',	
             	order: [1, 'asc' ],		        
         		//colReorder: true,		        
     
     	    	ajax: {
           		    url: 'getAllStagedUploads',
           		 	type: 'POST',
            		contentType: 'application/json',
            		data: function ( data ) {
            			showSpinner();            	
            			var myData = {version:"1.0", clientId:"gim"};
            			var innerData = {};
            			//innerData["designId"] = "123";
            			//innerData["pageCode"] = pageCode;
            			myData["data"] = innerData;	                  			
                		return JSON.stringify( myData );
     	        }, 
     	        "dataSrc": function (json) {
     	        	
     	        	// 4-25-2023
     	        //	wireObjectList = json.data.wireObjectList;	    
     	        	catalogObjectList = json.data.catalogObjectList;	
     	        	
     	        	hideSpinner();	// C.Sparks 1-19-19			    		
     	      	        	
     	        	// Data is JSON in an array, so we JSON.parse to get it out of the array
     	        	// [{"materialId":"100","materialName":"Copper Wire","materialDesc":"2 AWG Twisted Wire."},{"materialId":"100","materialName":"Copper Wire","materialDesc":"2 AWG Twisted Wire."},{"materialId":"100","materialName":"Copper Wire","materialDesc":"2 AWG Twisted Wire."}]     	          	
     	      // 	console.log(JSON.parse(wireObjectList));
     	      //  	return JSON.parse(wireObjectList);       	        
     	       // 	console.log(JSON.parse(catalogObjectList));
     	       
     	        	return JSON.parse(catalogObjectList);     
     	             	        
     	         }					       
        		},  
     
             columns: [	 
             	
                 { data: "uploadedFilename" },
                 { data: "productType" },
                 { data: "productNumber" },
                 { data: "productName" },
                 { data: "productDesc" },
                 { data: "activeStatus" ,
                 	"render": function(data, type, row, meta){	
                 		if('Y' == row['activeStatus']){                 			
                 			data = "<div class='d-flex'><a href='#' id='deactivateUser_"+row.lanId+"_"+row.activeStatus+"' onclick='deactivateRow(this)' class='button button--text'>Deactivate </a> <a href='#'  onclick='deleteRow(this,event)' id='deleteUser_"+row.lanId+"' class='button button--text ml-3'>Delete</a></div>"
                         } else	{
                 			data = "<div class='d-flex'><a href='#' id='deactivateUser_"+row.lanId+"_"+row.activeStatus+"' onclick='deactivateRow(this)' class='button button--text'>Activate </a> <a href='#'  onclick='deleteRow(this,event)' id='deleteUser_"+row.lanId+"' class='button button--text ml-3'>Delete</a></div>"
                 		 }
                         return data;
                      }},
                      
                      
            	],
            	
            	"createdRow": function( row, data, dataIndex ) {
            		//console.log(data.itemNumErrorFlag);            	
            	    if ( data.activeStatus == "N" ) {
            	    	 $(row).addClass('deactivated');
            	    	 // $('tr', row).eq(9).addClass("checked"); 
            	    }    
            	   
            	  },
            	  dom: '<t><"datatable-pagination d-flex flex-row justify-content-center justify-content-md-between align-items-center mt-2" <"datatable-pagination-group d-none d-md-block" l><"datatable-pagination-group" p><"datatable-pagination-group d-none d-md-block" i>>',
            	  
        		
         });
     }
        
     		
     		stepper1 = new Stepper($('.bs-stepper')[0], {
		        linear: true
		      }); 
		   
			
			
		    stepper1.to(3);
		    	
/* 	        if($('tr.de-alert-urgent').length > 0) {
	            $('.alert').removeClass('hidden').addClass('show');
	        } */
	        
	        
 		// SEARCH FILTER
 		$('#materialDataTable_filter input').keyup(function(){
 			table.search($(this).val()).draw() ;
 		});
     			
			
		$('#previousGoToPage2').click(function() {					
			showSpinner();								
			submitFormAjaxHTML('initUploadStep2', $("#dashboardFormDTO").serialize(), "commonResponse");														
		});	
		
		
		// 04-25-2023  Submit Button hit, save the uploaded docs to the DB.
		$('#submitDocsToDatabaseId').click(function() {					
			showSpinner();			
			//console.log (catalogObjectList) ;			
			$('#jsonUploadedCatalogObjectList').val( catalogObjectList ); 				
			submitFormAjaxHTML('processXlsFileSave', $("#dashboardFormDTO").serialize(), "commonResponse");														
		});	
		
   	 });  
    	
    	
    	
		function commonResponse(returnData) {	
			hideSpinner();
			$('#mainBody').html(returnData); 
			hideSpinner();
			 
		}
					
		
		</script>

  </head>
  
  <body>
 
	   <input type="hidden" id="jsonUploadedCatalogObjectList"  name="jsonUploadedCatalogObjectList" th:value="suckit"> 
     
          <section class="de-component h-100">
          
           <!--    <div class="de-component__container"> -->
              
                  <header class="de-component-header mb-0">
                      <h2 class="de-component-header__title">Upload Docs</h2>
                  </header>

                  <div id="stepper1" class="bs-stepper">
                  
                      <div class="bs-stepper-header m-auto bs-stepper-custom-width" role="tablist">
                          <div class="step" data-target="#step1">
                              <button type="button" class="btn btn-link step-trigger" role="tab" id="stepper1trigger1" aria-controls="test-l-1" aria-selected="true">
                                  <span class="bs-stepper-circle">1</span>
                                  <span class="bs-stepper-label"></span>
                              </button>
                          </div>
                          <div class="line"></div>
                          <div class="step" data-target="#step2">
                              <button type="button" class="btn btn-link step-trigger" role="tab" id="stepper1trigger2" aria-controls="test-l-2" aria-selected="false">
                                  <span class="bs-stepper-circle">2</span>
                                  <span class="bs-stepper-label"></span>
                              </button>
                          </div>
                          <div class="line"></div>
                          <div class="step active" data-target="#step3">
                              <button type="button" class="btn btn-link step-trigger" role="tab" id="stepper1trigger3" aria-controls="test-l-3" aria-selected="false">
                                  <span class="bs-stepper-circle">3</span>
                                  <span class="bs-stepper-label"></span>
                              </button>
                          </div>
                      </div>   
                      
                                   
                      <div class="bs-stepper-content">
                      
                          <div id="step1" role="tabpanel" class="content" aria-labelledby="stepper1trigger1">
                          </div>
                          
                          <div id="step2" role="tabpanel" class="content" aria-labelledby="stepper1trigger2">
                          </div>
                          
                          
                          <div id="step3" role="tabpanel" class="content active" aria-labelledby="stepper1trigger3">
                             
                              <div class="form-group text-center">
                                
                                 
			<div class="card">

				<div class="card-header"><i class="fas fa-user mr-2"></i> My Data:
		
				</div>

				<div class="de-component__container">				
                     
					 <div class="datatable-toolbar border border-bottom-0 text-secondary d-flex justify-content-between align-items-center py-2 px-3">
					 	<div class="datatable-toolbar-group">
					 		<div id="addbtn">
					 			<button class="button button--secondary-reversed w-auto" type="button" data-toggle="modal" data-target="#addUserModal" id="addEditUserlink"> Add User</button>
					 		</div>
					 	</div>
					 	<div class="datatable-toolbar-group">
					 		<div id="materialDataTable_filter" class="dataTables_filter">
					 			<label class="d-flex align-items-center">Search: <input type="search" class="form-control w-auto" placeholder="" aria-controls="materialDataTable"></label>
					 		</div>
					 	</div>
					 </div>	                     
                     
	                     <div id="editUserListHeaderId">
	                     
	                        <table id="materialDataTable" class="bg-white border border-top-0">
	                        
	                           <thead class="thead-light">
	                              <tr>
	                                 <th scope="col">Filename</th>
	                                 <th scope="col">Product Type</th>
	                                 <th scope="col">Number</th>
	                                 <th scope="col">Name</th>
	                                 <th scope="col">Description</th>
	                                 <th scope="col">Action</th>
	                              </tr>
	                           </thead>
	                        </table>
	                     </div>		                     
					
				</div>
			</div>



<br><br>
                               
                           <div class="py-4 text-center px-0 d-flex justify-content-between d-sm-block">
                                   <button type="button" id="previousGoToPage2" class="button button--previous" onclick="stepper1.previous();">Previous</button>

                                   <!-- C.Sparks 2-24-2020 -->
                                  <button type="button" class="button button--submit ml-3" id="submitDocsToDatabaseId" >Submit</button>

                               </div>
                           </div>
                           
                           
                           
                           
                           <div id="step4" role="tabpanel" class="content" aria-labelledby="stepper1trigger4">
                           </div>
                           
                           
                           
                          <div id="step5" role="tabpanel" class="content" aria-labelledby="stepper1trigger5">
                           </div>
                           
                           
                       </div>
                       
                   </div>

               </div>
               
               
	             <div id="deletealert" class="modal" tabindex="-1" role="dialog">
					<div class="modal-dialog" role="document">
						 <div class="modal-content">
						     <div class="modal-body"> 
						        <p><i class="fas fa-exclamation-triangle"></i> Are you sure you want to delete a line item? </p>
						     </div>
							<div class="modal-footer">
								<div class="button-group flex-row">
									<button type="button" id="deleteModalNo" class="button button--small button--text w-auto px-0 mx-5" data-dismiss="modal">Cancel</button>
									<button type="button" id="deleteModalYes" class="button button--small button--submit" data-dismiss="modal">Confirm</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			
			
			
				 <div class="modal fade alert-blocker" id="dupOptionIgnore" tabindex="-1" role="dialog" aria-labelledby="dupOptionOverwriteModal" aria-hidden="true" style="display:none">
				  <div class="modal-dialog modal-dialog-centered" role="document">
				    <div class="modal-content">
				      <div class="modal-body text-left">
						<h5 class="de-h5">Documents Already Uploaded</h5>
					    <p>The documents that you have submitted cannot be uploaded because they have already been approved for this P.O. Click 'Dismiss' to stay and make changes or Click 'Continue' to go forward.</p>
					    <ol type="1" id="duplicatesCanNotOverride" style="word-break: break-all">
					    </ol>
				      </div>
				      <div class="modal-footer" >
				      	  <button type="button" id="dupOptionIgnoreDismiss" class="button button--small button--text px-0 mx-5" style="width:7rem" data-dismiss="modal">Dismiss</button>
					      <button type="button" id="dupOptionIgnoreContinue" class="button button--small button--text w-auto px-0 mx-5" data-dismiss="modal">Continue</button>
				      </div>
				    </div>
				  </div>
				</div>
				
		
				<div class="modal fade alert-blocker" id="dupOptionOverwrite" tabindex="-1" role="dialog" aria-labelledby="dupOptionOverwriteModal" aria-hidden="true" style="display:none">
				  <div class="modal-dialog modal-dialog-centered" role="document">
				    <div class="modal-content">
				      <div class="modal-body text-left">
						<h5 class="de-h5">Documents Already Uploaded</h5>
					    <p>The documents that you have submitted match documents that have already been uploaded.Click 'Dismiss' to stay and make changes or  Click 'Overwrite' to save over the current set of documents and lose all changes.</p>
					    <ol type="1" id="duplicatesCanOverride" style="word-break: break-all">
					    </ol>
				      </div>
				      <div class="modal-footer">
				      	<button type="button" id="dupOptionOverwriteDismiss" class="button button--small button--text px-0 mx-5" style="width:7rem" data-dismiss="modal">Dismiss</button>					      
					    <button type="button" class="button button--secondary " id="dupOptionOverwriteSkip" data-dismiss="modal" style="width:15rem">Skip Duplicates</button>										        
					    <button type="button" class="button button--primary " id="dupOptionOverwriteOverride" data-dismiss="modal" style="width:15rem">Overwrite</button>										        
				      </div>
				    </div>
				  </div>
				</div>
									
           </section>  


  </body>
  
</html>